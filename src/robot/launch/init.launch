<launch>

	<!-- Setting and loading params and args -->
	<param name="use_sim_time" value="false" />
	<rosparam command="load" file="$(env HOME)/catkin_ws/params/myparams.yaml"/>
	<arg name="map" value="last_map"/>
	
	<!-- Setting local machine and running debug/gaphic ros tools  -->
	<machine name="$(env USER)" address="192.168.150.1" user="$(env USER)" default="true" env-loader="$(env HOME)/catkin_ws/devel/env.sh"/>
	<node name="rqt_gui" pkg="rqt_gui" type="rqt_gui"/>	
	<node name="rviz" pkg="rviz" type="rviz" args="-d $(env HOME)/catkin_ws/params/init.rviz"/>
	
	
	 
	<!-- ROBOT DRIVERS -->
	<include file="$(find robot)/launch/plaisir.machine">
		<arg name="robot" value="$(arg robot)"/> 
	</include>
	
	<node pkg="topic_router" name="robot_model" type="robot_model" respawn="true"/>
	<node pkg="topic_router" type="__init__.py" name="path_viz_pub" respawn="true"/>
	
	<!-- STATE MACHINE -->
	<include file="$(find robot)/launch/state_machine.machine">
		<arg name="robot" value="$(arg robot)"/> 
	</include>
	
	<!-- SCENARIO_PROCESS -->
	<include file="$(find robot)/launch/scenario_process.machine">
		<arg name="robot" value="$(arg robot)"/> 
	</include>
	
	<!-- LOCALISATION AND MAP -->
	<include file="$(find robot)/launch/localisation.launch">
		<arg name="robot" value="$(arg robot)"/>
		<arg name="map" value="$(arg map)"/> 
	</include>
	
	<!-- OBSTACLES -->
	<include file="$(find blob_detect)/launch/obstacle.launch">
		<arg name="robot" value="$(arg robot)"/>
	</include>
	
	<!-- PATH FINDING -->
	<node name="path_finding" pkg="path_finding" type="path_finding_server"/>

	<!-- MEDIA PLAYER -->
	<env name="DISPLAY" value=":0"/>
	<node name="media_player" pkg="media_player" type="__init__.py" machine="robot$(arg robot)"  respawn="true"/>
	
	<!-- GUI TOOLS -->
	<node name="gui_execution_diagram" pkg="gui_execution_diagram" type="__init__.py" machine="$(env USER)">
		<remap from="cmd_vel" to="robot$(arg robot)/cmd_vel"/>
		<remap from="scenario" to="robot$(arg robot)/scenario"/>
	</node>
</launch>



